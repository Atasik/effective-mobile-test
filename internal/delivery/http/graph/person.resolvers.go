package graph

// This file will be automatically regenerated based on the schema, any resolver implementations
// will be copied through when generating and any unknown code will be moved to the end.
// Code generated by github.com/99designs/gqlgen version v0.17.37

import (
	"context"
	"fio/internal/delivery/http/graph/model"
	"fio/internal/domain"
)

// AddPerson is the resolver for the addPerson field.
func (r *mutationResolver) AddPerson(ctx context.Context, input model.NewPerson) (int, error) {
	person := domain.Person{
		Name:       input.Name,
		Surname:    input.Surname,
		Patronymic: input.Patronymic,
	}
	r.validator.Struct(person)
	return r.services.Person.Add(person)
}

// DeletePerson is the resolver for the deletePerson field.
func (r *mutationResolver) DeletePerson(ctx context.Context, id int) (bool, error) {
	return r.services.Person.Delete(id)
}

// UpdatePerson is the resolver for the updatePerson field.
func (r *mutationResolver) UpdatePerson(ctx context.Context, id int, input domain.UpdatePersonInput) (bool, error) {
	err := input.Validate()
	if err != nil {
		return false, err
	}
	return r.services.Person.Update(id, input)
}

// GetPersons is the resolver for the getPersons field.
func (r *queryResolver) GetPersons(ctx context.Context, filter *domain.PersonFiltersQuery, pagination *domain.PaginationQuery) ([]domain.Person, error) {
	if filter == nil {
		filter = &domain.PersonFiltersQuery{}
	}
	if pagination == nil {
		pagination = &domain.PaginationQuery{
			Limit:  defaultLimit,
			Offset: (defaultPage - 1) * defaultLimit,
		}
	}
	opts := domain.PersonsQuery{
		PaginationQuery:    *pagination,
		PersonFiltersQuery: *filter,
	}
	return r.services.Person.GetAll(opts)
}

// Mutation returns MutationResolver implementation.
func (r *Resolver) Mutation() MutationResolver { return &mutationResolver{r} }

// Query returns QueryResolver implementation.
func (r *Resolver) Query() QueryResolver { return &queryResolver{r} }

type mutationResolver struct{ *Resolver }
type queryResolver struct{ *Resolver }
